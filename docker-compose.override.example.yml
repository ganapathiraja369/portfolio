# Development Override Configuration
# Copy this file to docker-compose.override.yml and customize for local development
# This file will be automatically loaded by docker-compose alongside docker-compose.yml

version: '3.8'

services:
  portfolio-api:
    # Enable debug mode for development
    environment:
      LOGGING_LEVEL_ROOT: DEBUG
      LOGGING_LEVEL_COM_EXAMPLE: DEBUG
    
    # Mount source code for hot-reload (requires Spring DevTools)
    volumes:
      - ./src:/app/src
      - ./logs:/app/logs
    
    # Show all output instead of structured logging
    stdin_open: true
    tty: true
    
    # Resource limits for development
    deploy:
      resources:
        limits:
          cpus: '2'
          memory: 1G
        reservations:
          cpus: '1'
          memory: 512M

  mongodb:
    # Additional MongoDB configuration for development
    environment:
      # Enable verbose logging (optional, may impact performance)
      # MONGO_INITDB_ROOT_AUTH_MODE: scram
      pass: portfolio_password
    
    # Expose on non-standard port if needed (uncomment and change)
    # ports:
    #   - "27018:27017"
    
    # Mount custom MongoDB scripts (optional)
    # volumes:
    #   - ./mongo-init.js:/docker-entrypoint-initdb.d/init.js

# Optional: Uncomment to enable MongoDB GUI (Mongo Express)
# mongo-express:
#   image: mongo-express:latest
#   container_name: mongo-express
#   restart: unless-stopped
#   ports:
#     - "8081:8081"
#   environment:
#     ME_CONFIG_MONGODB_ADMINUSERNAME: portfolio_user
#     ME_CONFIG_MONGODB_ADMINPASSWORD: portfolio_password
#     ME_CONFIG_MONGODB_URL: mongodb://portfolio_user:portfolio_password@mongodb:27017
#     ME_CONFIG_BASICAUTH_USERNAME: admin
#     ME_CONFIG_BASICAUTH_PASSWORD: admin
#   depends_on:
#     - mongodb
#   networks:
#     - portfolio-network
